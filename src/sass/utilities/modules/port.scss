@use 'sass:meta';
@use 'sass:string';
@use 'sass:list';
@use 'sass:map';
@use 'obj';

@function has-port($this, $port) {
  @return map.has-key(obj.get($this, 'ports'), $port);
}

@function get-port($this, $port) {
  @if not has-port($this, $port) { @error "no such port '#{$port}'"; }

  @return map.get(obj.get($this, 'ports'), $port);
}

@function set-port($this, $port, $value) {
  $ports: map.set(obj.get($this, 'ports'), $port, $value);
  @return obj.set($this, 'ports', $ports);
}

@function create($ports: ()) {
  @return obj.create-class('port', (
    'ports': map.deep-merge(('default': null), $ports),
    'has-port': get-function('has-port'),
    'get-port': get-function('get-port'),
    'set-port': get-function('set-port'),
  ));
}